---
title: Traffic Data Analysis
output: html_document
---

```{r}
library(ggplot2)
library(dplyr)
```

#Data Reading
```{r}
df <- read.csv(file="../traffic-data.csv", head=TRUE, sep=",")
```

# Data Cleaning

Check for duplicate rows 
```{r}
nrow(df) - nrow(unique(df))
```

Remove Columns which has one unique value  
```{r}
df <- Filter(function(x)(length(unique(x))>2), df)
ncol(df)
```

Check mean of NA in each colmun
```{r}
na_means = c()
for (i in 1:ncol(df)) {
     na_means  <- c(na_means,  mean(is.na(df[i])))
}
na_means
```

Last two columns have big NA mean. by looking in the dataset it appeas to be images which can be excluded from the anaylsis. So, remove these two columns
```{r}
df = subset(df, select = -c(ncol(df), ncol(df)-1) )
ncol(df)
```

Check mean of unique values percentage in each colmun
```{r}
unique_values_percentage = c()
for (i in 1:ncol(df)) {
     val = length(unique(df[i])) / length(df[i])
     unique_values_percentage  <- c(unique_values_percentage,  val)
}
#unique_values_percentage
```
After examining the meaning of data, we can get rid of the duplicate rows(have the same comment id)
```{r}
nrow(df)
df <- subset(df, !duplicated(df[,13]))
nrow(df)
```